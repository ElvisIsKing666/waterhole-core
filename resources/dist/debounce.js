class mt{constructor(e,i,{tabInsertsSuggestions:n,defaultFirstOption:o}={}){this.input=e,this.list=i,this.tabInsertsSuggestions=n??!0,this.defaultFirstOption=o??!1,this.isComposing=!1,i.id||(i.id=`combobox-${Math.random().toString().slice(2,6)}`),this.ctrlBindings=!!navigator.userAgent.match(/Macintosh/),this.keyboardEventHandler=s=>M(s,this),this.compositionEventHandler=s=>q(s,this),this.inputHandler=this.clearSelection.bind(this),e.setAttribute("role","combobox"),e.setAttribute("aria-controls",i.id),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-haspopup","listbox")}destroy(){this.clearSelection(),this.stop(),this.input.removeAttribute("role"),this.input.removeAttribute("aria-controls"),this.input.removeAttribute("aria-expanded"),this.input.removeAttribute("aria-autocomplete"),this.input.removeAttribute("aria-haspopup")}start(){this.input.setAttribute("aria-expanded","true"),this.input.addEventListener("compositionstart",this.compositionEventHandler),this.input.addEventListener("compositionend",this.compositionEventHandler),this.input.addEventListener("input",this.inputHandler),this.input.addEventListener("keydown",this.keyboardEventHandler),this.list.addEventListener("click",j),this.indicateDefaultOption()}stop(){this.clearSelection(),this.input.setAttribute("aria-expanded","false"),this.input.removeEventListener("compositionstart",this.compositionEventHandler),this.input.removeEventListener("compositionend",this.compositionEventHandler),this.input.removeEventListener("input",this.inputHandler),this.input.removeEventListener("keydown",this.keyboardEventHandler),this.list.removeEventListener("click",j)}indicateDefaultOption(){var e;this.defaultFirstOption&&((e=Array.from(this.list.querySelectorAll('[role="option"]:not([aria-disabled="true"])')).filter(E)[0])===null||e===void 0||e.setAttribute("data-combobox-option-default","true"))}navigate(e=1){const i=Array.from(this.list.querySelectorAll('[aria-selected="true"]')).filter(E)[0],n=Array.from(this.list.querySelectorAll('[role="option"]')).filter(E),o=n.indexOf(i);if(o===n.length-1&&e===1||o===0&&e===-1){this.clearSelection(),this.input.focus();return}let s=e===1?0:n.length-1;if(i&&o>=0){const r=o+e;r>=0&&r<n.length&&(s=r)}const c=n[s];if(c)for(const r of n)r.removeAttribute("data-combobox-option-default"),c===r?(this.input.setAttribute("aria-activedescendant",c.id),c.setAttribute("aria-selected","true"),R(c),P(this.list,c)):r.removeAttribute("aria-selected")}clearSelection(){this.input.removeAttribute("aria-activedescendant");for(const e of this.list.querySelectorAll('[aria-selected="true"]'))e.removeAttribute("aria-selected");this.indicateDefaultOption()}}function M(t,e){if(!(t.shiftKey||t.metaKey||t.altKey)&&!(!e.ctrlBindings&&t.ctrlKey)&&!e.isComposing)switch(t.key){case"Enter":H(e.input,e.list)&&t.preventDefault();break;case"Tab":e.tabInsertsSuggestions&&H(e.input,e.list)&&t.preventDefault();break;case"Escape":e.clearSelection();break;case"ArrowDown":e.navigate(1),t.preventDefault();break;case"ArrowUp":e.navigate(-1),t.preventDefault();break;case"n":e.ctrlBindings&&t.ctrlKey&&(e.navigate(1),t.preventDefault());break;case"p":e.ctrlBindings&&t.ctrlKey&&(e.navigate(-1),t.preventDefault());break;default:if(t.ctrlKey)break;e.clearSelection()}}function j(t){if(!(t.target instanceof Element))return;const e=t.target.closest('[role="option"]');e&&e.getAttribute("aria-disabled")!=="true"&&N(e,{event:t})}function H(t,e){const i=e.querySelector('[aria-selected="true"], [data-combobox-option-default="true"]');return i?(i.getAttribute("aria-disabled")==="true"||i.click(),!0):!1}function N(t,e){t.dispatchEvent(new CustomEvent("combobox-commit",{bubbles:!0,detail:e}))}function R(t){t.dispatchEvent(new Event("combobox-select",{bubbles:!0}))}function E(t){return!t.hidden&&!(t instanceof HTMLInputElement&&t.type==="hidden")&&(t.offsetWidth>0||t.offsetHeight>0)}function q(t,e){e.isComposing=t.type==="compositionstart",document.getElementById(e.input.getAttribute("aria-controls")||"")&&e.clearSelection()}function P(t,e){F(t,e)||(t.scrollTop=e.offsetTop)}function F(t,e){const i=t.scrollTop,n=i+t.clientHeight,o=e.offsetTop,s=o+e.clientHeight;return o>=i&&s<=n}function gt(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||t.button!==void 0&&t.button!==0}function bt(t,e=1){const i=t.getBoundingClientRect();return-i.top/i.height<e&&(i.bottom-window.innerHeight)/i.height<e}function vt(){var t;return((t=document.getElementById("header"))==null?void 0:t.offsetHeight)||0}function yt(t){return t.toLowerCase().replace(/[^a-z0-9]/gi,"-").replace(/-+/g,"-").replace(/-$|^-/g,"")}function Et(t){var i,n;const e=document.getElementById(t);return(n=(i=e==null?void 0:e.content)==null?void 0:i.firstElementChild)==null?void 0:n.cloneNode(!0)}function Tt(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null}var U=typeof global=="object"&&global&&global.Object===Object&&global,_=typeof self=="object"&&self&&self.Object===Object&&self,B=U||_||Function("return this")(),g=B.Symbol,x=Object.prototype,G=x.hasOwnProperty,V=x.toString,h=g?g.toStringTag:void 0;function z(t){var e=G.call(t,h),i=t[h];try{t[h]=void 0;var n=!0}catch{}var o=V.call(t);return n&&(e?t[h]=i:delete t[h]),o}var X=Object.prototype,J=X.toString;function Q(t){return J.call(t)}var Y="[object Null]",Z="[object Undefined]",w=g?g.toStringTag:void 0;function tt(t){return t==null?t===void 0?Z:Y:w&&w in Object(t)?z(t):Q(t)}function et(t){return t!=null&&typeof t=="object"}var it="[object Symbol]";function nt(t){return typeof t=="symbol"||et(t)&&tt(t)==it}var rt=/\s/;function ot(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var at=/^\s+/;function st(t){return t&&t.slice(0,ot(t)+1).replace(at,"")}function A(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var C=NaN,ct=/^[-+]0x[0-9a-f]+$/i,ut=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,ft=parseInt;function L(t){if(typeof t=="number")return t;if(nt(t))return C;if(A(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=A(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=st(t);var i=ut.test(t);return i||lt.test(t)?ft(t.slice(2),i?2:8):ct.test(t)?C:+t}var T=function(){return B.Date.now()},dt="Expected a function",pt=Math.max,ht=Math.min;function At(t,e,i){var n,o,s,c,r,l,f=0,S=!1,d=!1,b=!0;if(typeof t!="function")throw new TypeError(dt);e=L(e)||0,A(i)&&(S=!!i.leading,d="maxWait"in i,s=d?pt(L(i.maxWait)||0,e):s,b="trailing"in i?!!i.trailing:b);function v(a){var u=n,p=o;return n=o=void 0,f=a,c=t.apply(p,u),c}function K(a){return f=a,r=setTimeout(m,e),S?v(a):c}function $(a){var u=a-l,p=a-f,I=e-u;return d?ht(I,s-p):I}function k(a){var u=a-l,p=a-f;return l===void 0||u>=e||u<0||d&&p>=s}function m(){var a=T();if(k(a))return O(a);r=setTimeout(m,$(a))}function O(a){return r=void 0,b&&n?v(a):(n=o=void 0,c)}function D(){r!==void 0&&clearTimeout(r),f=0,n=l=o=r=void 0}function W(){return r===void 0?c:O(T())}function y(){var a=T(),u=k(a);if(n=arguments,o=this,l=a,u){if(r===void 0)return K(l);if(d)return clearTimeout(r),r=setTimeout(m,e),v(l)}return r===void 0&&(r=setTimeout(m,e)),c}return y.cancel=D,y.flush=W,y}export{mt as C,Tt as a,yt as b,Et as c,At as d,vt as g,bt as i,gt as s};
